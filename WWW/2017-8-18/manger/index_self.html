<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <!-- ie ÊåâÁÖß ÊúÄÊñ∞ÁöÑ ÊñπÂºèÊ∏≤Êüì -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- ËßÜÂè£ -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->
    <!--<link href="lib/css/bootstrap.min.css" rel="stylesheet">-->
    <!-- bootstrapÁöÑ Ê†∑Âºè -->
    <link href="lib/css/bootstrap.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!-- ÂÖºÂÆπ ie9
    html5shiv html5ÁöÑÊñ∞ËØ≠‰πâÊ†áÁ≠æ
    respond ‰ΩéÁâàÊú¨ÁöÑie‰∏≠ ‰∏çÊîØÊåÅ Â™í‰ΩìÊü•ËØ¢ @media
   -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
    <style>
        h1 {
            border-bottom: 1px solid #ccc;
            padding-bottom: 20px;
        }

        .zombie-panel table th {
            text-align: center;
            background-color: #eee;
        }

        .zombie-panel table td {
            text-align: center;
        }

        /* Ê∏ÖÈô§ Â∫ïÈÉ®ÁöÑÊ†∑Âºè */

        .zombie-panel .pagination {
            margin: 0;
        }

        .zombie-panel {
            position: relative;
        }

        #editModal .modal-dialog {
            position: relative;
        }

        #coverModal {
            background: url('img/loading.gif')no-repeat center;
        }

        a.disabled {
            cursor: not-allowed;
        }
    </style>
</head>

<body>
    <!-- ÊúÄÂ§ñÂ±ÇÁöÑÂÆπÂô® -->
    <div class="container">
        <!-- È°∂ÈÉ®Ê†áÈ¢ò -->
        <h1>‰∫∫ÂëòÁÆ°ÁêÜ_coding<small>--ÁâàÊú¨1.0</small></h1>
        <!-- Èù¢Êùø -->
        <div class="zombie-panel panel panel-default">
            <!-- È°∂ÈÉ® -->
            <div class="panel-heading">
                <h3 class="panel-title">‰ø°ÊÅØÂàóË°®</h3>
            </div>
            <!-- ÂÜÖÂÆπÂå∫Âüü -->
            <div class="panel-body">
                <!-- Ë°®Ê†º -->
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th width='10%'>Â∫èÂè∑</th>
                            <th width='15%'>ÂßìÂêç</th>
                            <th width='15%'>Âπ¥ÈæÑ</th>
                            <th width='20%'>Â≠¶Ê†°</th>
                            <th width='20%'>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!--<tr>
              <td>1</td>
              <td>Ê∞¥Ê°∂ÂÉµÂ∞∏</td>
              <td>18</td>
              <td>zombie1</td>
              <td>ÂÉµÂ∞∏Â§ßÂ≠¶</td>
              <td>
                <button class='btn btn-default btn-xs glyphicon glyphicon-remove'></button>
                <button class='btn btn-default btn-xs glyphicon glyphicon-edit'></button>
              </td>
            </tr>-->
                    </tbody>
                </table>
            </div>
            <!-- Â∫ïÈÉ®Âå∫Âüü -->
            <div class="panel-footer">
                <nav class='clearfix' aria-label="Page navigation">
                    <!-- ÂàÜÈ°µÂô® -->
                    <ul class="pagination pull-right">
                        <li>
                            <a href="#" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li><a href="#">1</a></li>
                        <li><a href="#">/</a></li>
                        <li><a href="#">1</a></li>
                        <li>
                            <a href="javascript:void(0)" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                    <!-- Êñ∞Â¢ûÊåâÈíÆ -->
                    <button data-toggle="modal" data-target="#addModal" class='btn btn-danger'>Êñ∞Â¢û</button>
                </nav>
            </div>
        </div>
    </div>

    <!-- Êñ∞Â¢ûÊ®°ÊÄÅÊ°Ü #addModal -->
    <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Êñ∞Â¢ûÁ™óÂè£</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="addname">ÂßìÂêç</label>
                            <input type="text" name='name' class="form-control" id="addname" placeholder="ËØ∑ËæìÂÖ•ÁúüÂÆûÂßìÂêç">
                        </div>
                        <div class="form-group">
                            <label for="addpassword">ÂØÜÁ†Å</label>
                            <input type="password" name='password' class="form-control" id="addpassword"
                                placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å">
                        </div>
                        <div class="form-group">
                            <label for="addschool">Â≠¶Ê†°</label>
                            <input type="text" class="form-control" name='school' id="addschool" placeholder="ËØ∑ËæìÂÖ•Â≠¶Ê†°">
                        </div>
                        <div class="form-group">
                            <label for="addage">Âπ¥ÈæÑ</label>
                            <input type="text" name='age' class="form-control" id="addage" placeholder="ËØ∑ËæìÂÖ•Âπ¥ÈæÑ">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">‰øù&nbsp;Â≠ò</button>
                </div>
            </div>
        </div>
    </div>
    <!-- ‰øÆÊîπÊ®°ÊÄÅÊ°ÜÊ®°ÊÄÅÊ°Ü #addModal -->
    <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">‰øÆÊîπÁ™óÂè£</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="editname">ÂßìÂêç</label>
                            <input type="text" name='name' class="form-control" id="editname" placeholder="ËØ∑ËæìÂÖ•ÁúüÂÆûÂßìÂêç">
                        </div>
                        <div class="form-group">
                            <label for="editpassword">ÂØÜÁ†Å</label>
                            <input type="password" name='password' class="form-control" id="editpassword"
                                placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å">
                        </div>
                        <div class="form-group">
                            <label for="editschool">Â≠¶Ê†°</label>
                            <input type="text" class="form-control" name='school' id="editschool" placeholder="ËØ∑ËæìÂÖ•Â≠¶Ê†°">
                        </div>
                        <div class="form-group">
                            <label for="editage">Âπ¥ÈæÑ</label>
                            <input type="text" name='age' class="form-control" id="editage" placeholder="ËØ∑ËæìÂÖ•Âπ¥ÈæÑ">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">‰øùÂ≠ò</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Âà†Èô§Ê®°ÊÄÅÊ°Ü #removeModal -->
    <div class="modal fade" id="removeModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Âà†Èô§Á™óÂè£</h4>
                </div>
                <div class="modal-body">
                    <h2>‰Ω†ÁúüÁöÑÊÉ≥Ê∏ÖÊ•ö‰∫ÜÔºåÂà†‰∫ÜÂèØÂ∞±Ê≤°Êúâ‰∫ÜÂì¶üòÅ</h2>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">ÊàëÊÉ≥Â•Ω‰∫Ü</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÈÅÆÊå°Áî® Ê®°ÊÄÅÊ°Ü  -->
    <div class="modal fade" id="coverModal" tabindex="-1" role="dialog" data-backdrop='static'
        aria-labelledby="myModalLabel">
    </div>
</body>

</html>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="lib/js/jquery-1.12.4.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="lib/js/bootstrap.min.js"></script>

<!-- ÂØºÂÖ•Ê®°ÊùøÂºïÊìé -->
<script src="./lib/js/template-web.js"></script>
<!-- ÂÆö‰πâÊ®°Êùø  -->
<script type="text/html" id='template'>
    {{each list}}
    <tr>
        <td>{{$value.id}}</td>
        <td>{{$value.name}}</td>
        <td>{{$value.age}}</td>
        <td>{{$value.school}}</td>
        <td>
          <button data-toggle="modal" data-target="#removeModal" class="btn btn-default btn-xs glyphicon glyphicon-remove"></button>
          <button class="btn btn-default btn-xs glyphicon glyphicon-edit"></button>
        </td>
      </tr>
      {{/each}}
</script>
<script>
    var page = 1;
    function getData() {
        $('#coverModal').modal('show');
        $.ajax({
            url: 'http://172.21.66.71/2017-8-18/00.API/api_cors/findUsers.php',
            data: {
                pageNum: page,
                pageSize: 6
            }
            ,
            success: function (data) {
                console.log(data);
                var result = template('template', data);
                $('tbody').html(result);
                $('#coverModal').modal('hide');
                var totalPage = Math.ceil(data.total / data.pageSize);
                console.log(totalPage);
                $('.pagination li:eq(3) a').html(totalPage);
                $('.pagination li:eq(1) a').html(data.pageNum);
                if ($('.pagination li:eq(1) a').html() == totalPage) {
                    $('a[aria-label="Next"]').addClass('disabled')
                } else {
                    $('a[aria-label="Next"]').removeClass('disabled')
                }
                if ($('.pagination li:eq(1) a').html() == 1) {
                    $('a[aria-label="Previous"]').addClass('disabled')
                } else {
                    $('a[aria-label="Previous"]').removeClass('disabled')
                }
            }
        })

    }

    $(function () {
        getData();
        $('a[aria-label="Next"]').click(function () {
            if ($(this).hasClass('disabled')) {
                return;
            }
            page++;
            getData();
        })
        $('a[aria-label="Previous"]').click(function () {
            if ($(this).hasClass('disabled')) {
                return;
            }
            page--;
            getData();
        })
        $('#removeModal .btn-danger').click(function () {
            $.ajax({
                url: 'http://172.21.66.71/2017-8-18/00.API/api_cors/removeUser.php',
                data: {
                    id: editId,
                },
                type: 'post',
                success: function (data) {
                    console.log(data);
                }
            })
            getData();
        })
        var editId;
        $('tbody').on('click', '.glyphicon-remove', function () {
            editId = $(this).parent().siblings().first().html();
            console.log(editId);
        })
        $('tbody').on('click', '.glyphicon-edit', function () {
            editId = $(this).parent().siblings().first().html();
            // Ëé∑ÂèñÂΩìÂâçÁöÑÊï∞ÊçÆ
            $.ajax({
                url: 'http://172.21.66.71/2017-8-18/00.API/api_cors/getOneUser.php',
                data: {
                    id: editId
                },
                success: function (data) {
                    console.log(data);
                    $('#editModal').find('input[name=name]').val(data.list[0].name)
                    $('#editModal').find('input[name=password]').val(data.list[0].password)
                    $('#editModal').find('input[name=school]').val(data.list[0].school)
                    $('#editModal').find('input[name=age]').val(data.list[0].age)
                    $("#editModal").modal('show');
                }
            })
        })
        $('#editModal .btn-primary').click(function () {
            console.log($('#editModal form').serialize() + '&id=' + editId);
            $.ajax({
                url: 'http://172.21.66.71/2017-8-18/00.API/api_cors/modifyUser.php',
                data: ($('#editModal form').serialize() + '&id=' + editId),
                type: 'post',
                success: function (data) {
                    console.log(data);
                }
            })
            getData();
        })
        $('#addModal .btn-primary').click(function () {
            console.log($('#addModal form').serialize() + '&id=' + editId);
            $.ajax({
                url: 'http://172.21.66.71/2017-8-18/00.API/api_cors/saveUser.php',
                data: ($('#addModal form').serialize()),
                type: 'post',
                success: function (data) {
                    console.log(data);
                }
            })
            getData();
        })



    })
</script>
<!-- 
  ÈúÄÊ±Ç
    ÈúÄÊ±Ç1
      È°µÈù¢ÊâìÂºÄ
        Êó†Âà∑Êñ∞Âä†ËΩΩ Á¨¨‰∏ÄÈ°µ Êï∞ÊçÆ
          ÂÖàÂºπÂá∫ÈÅÆÁΩ©Â±Ç
            Êï∞ÊçÆÂä†ËΩΩÂõûÊù•‰πãÂêé
              ÂÖ≥Èó≠ÈÅÆÁΩ©Â±Ç
              Ê∏≤ÊüìÂà∞È°µÈù¢‰∏ä
              ‰øÆÊîπÈ°µÁ†ÅÊòæÁ§∫
              Âà§Êñ≠ÊòØÂê¶‰∏∫ÊúÄÂêé‰∏ÄÈ°µ
                Â¶ÇÊûúÊòØ,Á¶ÅÁî®‰∏ã‰∏ÄÈ°µ
                Âèç‰πã,ÂêØÁî®‰∏ã‰∏ÄÈ°µ
    ÈúÄÊ±Ç2 
       ÁÇπÂáª‰∏ã‰∏ÄÈ°µÊåâÈíÆ
        Êó†Âà∑Êñ∞Ëé∑Âèñ‰∏ã‰∏ÄÈ°µÊï∞ÊçÆ
          ÂÖàÂºπÂá∫ÈÅÆÁΩ©Â±Ç
            Êï∞ÊçÆÂä†ËΩΩÂõûÊù•‰πãÂêé
              ÂÖ≥Èó≠ÈÅÆÁΩ©Â±Ç
              Ê∏≤ÊüìÂà∞È°µÈù¢‰∏ä
              ‰øÆÊîπÈ°µÁ†ÅÊòæÁ§∫
              Âà§Êñ≠ÊòØÂê¶‰∏∫ÊúÄÂêé‰∏ÄÈ°µ
                Â¶ÇÊûúÊòØ,Á¶ÅÁî®‰∏ã‰∏ÄÈ°µ
                Âèç‰πã,ÂêØÁî®‰∏ã‰∏ÄÈ°µ
    ÈúÄÊ±Ç3 
       ÁÇπÂáª‰∏ä‰∏ÄÈ°µÊåâÈíÆ
        Êó†Âà∑Êñ∞Ëé∑Âèñ‰∏ä‰∏ÄÈ°µÊï∞ÊçÆ
          ÂÖàÂºπÂá∫ÈÅÆÁΩ©Â±Ç
            Êï∞ÊçÆÂä†ËΩΩÂõûÊù•‰πãÂêé
              ÂÖ≥Èó≠ÈÅÆÁΩ©Â±Ç
              Ê∏≤ÊüìÂà∞È°µÈù¢‰∏ä
              Âà§Êñ≠ÊòØÂê¶‰∏∫Á¨¨‰∏ÄÈ°µ
                Â¶ÇÊûúÊòØ,Á¶ÅÁî®‰∏ä‰∏ÄÈ°µ
                Âèç‰πã,ÂêØÁî®‰∏ä‰∏ÄÈ°µ
    ÈúÄÊ±Ç4
       ÁÇπÂáªÊñ∞Â¢ûÁ™óÂè£‰∏≠ÁöÑÊñ∞Â¢ûÊåâÈíÆ
        Êó†Âà∑Êñ∞Ê∑ªÂä†Êï∞ÊçÆ
          ÂÖàÂºπÂá∫ÈÅÆÁΩ©Â±Ç
            Ê∑ªÂä†ÊàêÂäü‰πãÂêé
              ÂÖ≥Èó≠ÈÅÆÁΩ©Â±Ç
              Ê∏≤ÊüìÂà∞È°µÈù¢‰∏ä
              Âà§Êñ≠ÊòØÂê¶‰∏∫Á¨¨‰∏ÄÈ°µ
                Â¶ÇÊûúÊòØ,Á¶ÅÁî®‰∏ä‰∏ÄÈ°µ
                Âèç‰πã,ÂêØÁî®‰∏ä‰∏ÄÈ°µ
 -->